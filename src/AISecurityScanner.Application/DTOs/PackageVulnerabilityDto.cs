using System;
using AISecurityScanner.Domain.Enums;

namespace AISecurityScanner.Application.DTOs
{
    public class PackageVulnerabilityDto
    {
        public Guid Id { get; set; }
        public Guid SecurityScanId { get; set; }
        public string PackageName { get; set; } = string.Empty;
        public string Version { get; set; } = string.Empty;
        public string PackageManager { get; set; } = string.Empty;
        public string? LatestVersion { get; set; }
        public string? RecommendedVersion { get; set; }
        public bool IsOutdated { get; set; }
        public bool HasKnownVulnerabilities { get; set; }
        public string? CVE { get; set; }
        public string? CVSS { get; set; }
        public VulnerabilitySeverity Severity { get; set; }
        public string? Description { get; set; }
        public string? AdvisoryUrl { get; set; }
        public string? FilePath { get; set; }
        public DateTime? PublishedDate { get; set; }
        public DateTime? DisclosedDate { get; set; }
        public bool IsDirectDependency { get; set; }
        public string? DependencyPath { get; set; }
        public int? LicenseRisk { get; set; }
        public string? License { get; set; }
        
        // AI Hallucination fields
        public bool IsPotentiallyHallucinated { get; set; }
        public decimal HallucinationConfidence { get; set; }
        public string? HallucinationReason { get; set; }
        public bool PackageExists { get; set; }
        
        public DateTime CreatedAt { get; set; }
        public DateTime? LastCheckedAt { get; set; }
    }

    public class PackageScanSummary
    {
        public int TotalPackages { get; set; }
        public int VulnerablePackages { get; set; }
        public int OutdatedPackages { get; set; }
        public int HallucinatedPackages { get; set; }
        public Dictionary<VulnerabilitySeverity, int> VulnerabilitiesBySeverity { get; set; } = new();
        public Dictionary<string, int> VulnerabilitiesByPackageManager { get; set; } = new();
        public List<PackageVulnerabilityDto> CriticalVulnerabilities { get; set; } = new();
        public List<PackageVulnerabilityDto> HallucinatedPackagesList { get; set; } = new();
    }
}