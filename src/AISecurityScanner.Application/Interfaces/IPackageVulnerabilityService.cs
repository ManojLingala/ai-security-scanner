using System;
using System.Collections.Generic;
using System.Threading;
using System.Threading.Tasks;
using AISecurityScanner.Domain.Entities;

namespace AISecurityScanner.Application.Interfaces
{
    public interface IPackageVulnerabilityService
    {
        Task<List<PackageVulnerability>> ScanNuGetPackagesAsync(
            string projectFilePath, 
            Guid scanId,
            CancellationToken cancellationToken = default);
        
        Task<List<PackageVulnerability>> ScanNpmPackagesAsync(
            string packageJsonPath, 
            Guid scanId,
            CancellationToken cancellationToken = default);
        
        Task<List<PackageVulnerability>> ScanPythonPackagesAsync(
            string requirementsPath, 
            Guid scanId,
            CancellationToken cancellationToken = default);
        
        Task<bool> CheckPackageExistsAsync(
            string packageName, 
            string packageManager,
            CancellationToken cancellationToken = default);
        
        Task<PackageVulnerability> CheckForHallucinationAsync(
            PackageVulnerability vulnerability,
            CancellationToken cancellationToken = default);
        
        Task<List<PackageVulnerability>> GetVulnerabilitiesForScanAsync(
            Guid scanId,
            CancellationToken cancellationToken = default);
    }
}